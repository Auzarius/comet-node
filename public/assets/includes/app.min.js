angular.module("mainCtrl",["angularMoment"]).controller("mainController",["$rootScope","$location","Auth",function(n,o,t){var a=this;a.loggedIn=t.isLoggedIn(),n.$on("$routeChangeStart",function(n){a.loggedIn=t.isLoggedIn(),a.loggedIn?(a.location=o.path(),t.getUser().then(function(n){a.user=n.data}),"/signin"==o.path()&&o.path("/")):"/"==o.path()||"/signin"==o.path()||o.path("/signin")}),n.$on("$routeChangeSuccess",function(){$("html, body").animate({scrollTop:0},200)}),a.doLogin=function(){a.processing=!0,a.error="",t.login(a.loginData.username,a.loginData.password).success(function(n){a.processing=!1,a.user=a.loginData.username,n.success?o.path("/"):a.error=n.message})},a.doLogout=function(){t.logout(),a.user=null,o.path("/signin")}}]);
angular.module("authService",[]).factory("Auth",["$http","$q","AuthToken",function(e,t,n){var o={};return o.login=function(t,o){return e.post("/api/authenticate",{username:t,password:o}).success(function(e){return n.setToken(e.token),e})},o.logout=function(){n.setToken()},o.isLoggedIn=function(){return n.getToken()?!0:!1},o.getUser=function(){return n.getToken()?e.get("/api/me",{cache:!1}):t.reject({message:"User has no token."})},o}]).factory("AuthToken",["$window",function(e){var t={};return t.getToken=function(){return e.localStorage.getItem("token")},t.setToken=function(t){t?e.localStorage.setItem("token",t):e.localStorage.removeItem("token")},t}]).factory("AuthInterceptor",["$q","$location","AuthToken",function(e,t,n){var o={};return o.request=function(e){var t=n.getToken();return t&&(e.headers["x-access-token"]=t),e},o.responseError=function(o){return 401==o.status?(n.setToken(),t.path("/signin")):403==o.status&&t.path("/forbidden"),e.reject(o)},o}]);
angular.module("ticketCtrl",["ticketService"]).controller("ticketController",["Ticket",function(e){var s=this;s.processing=!0,e.active().success(function(e){0==e.success||null==e.data?s.tickets=null:s.tickets=e.data,s.processing=!1}).error(function(e){e&&(s.message=e),s.tickets=null,s.processing=!1}),s.deleteTicket=function(t){s.processing=!0,e["delete"](t).success(function(t){t.success&&e.active().success(function(e){s.tickets=e.data}),s.processing=!1,s.message=t.message})}}]).controller("ticketAllController",["Ticket",function(e){var s=this;s.processing=!0,e.all().success(function(e){0==e.success||null==e.data?s.tickets=null:s.tickets=e.data,s.processing=!1}),s.deleteTicket=function(t){s.processing=!0,e["delete"](t).success(function(t){t.success&&e.all().success(function(e){s.tickets=e.data}),s.processing=!1,s.message=t.message})}}]).controller("ticketCreateController",["$scope","Ticket",function(e,s){var t=this;t.saveTicket=function(){t.processing=!0,t.message="",s.create(t.ticketData).success(function(s){t.processing=!1,t.message=s.message,t.ticketData={},e.ticketform.$setPristine(),$("html, body").animate({scrollTop:0},200)})}}]).controller("ticketEditController",["$routeParams","Ticket",function(e,s){var t=this;s.get(e.ticket_id).success(function(e){t.ticketData=e.data}),t.saveTicket=function(){t.processing=!0,t.message="",s.update(e.ticket_id,t.ticketData).success(function(e){t.processing=!1,t.message=e.message,$("html, body").animate({scrollTop:0},200)})}}]).controller("ticketViewController",["$scope","$routeParams","$location","Ticket",function(e,s,t,c){var n=this;n.processing=!0,n.event_processing=!0,e.eventForm={},c.get(s.ticket_id).success(function(e){n.ticket=e.data,n.processing=!1}).error(function(e){n.processing=!1,n.message=e}),n.deleteTicket=function(e){n.processing=!0,c["delete"](e).success(function(e){n.processing=!1,e.success&&t.path("/tickets")})},n.getEvents=function(){c.event.get(s.ticket_id).success(function(e){n.events=e.data,n.event_processing=!1}).error(function(e){n.event_processing=!1,n.message=e})},n.getEvents(),n.addEvent=function(){n.event_processing=!0,n.message="",c.event.create(s.ticket_id,n.eventData).success(function(s){n.event_processing=!1,n.eventData={},e.eventform.$setPristine(),n.message=s.message,n.getEvents()}).error(function(e){n.event_processing=!1,n.message=e.message})},n.deleteEvent=function(e){n.event_processing=!0,c.event["delete"](e).success(function(e){e.success&&n.getEvents(),n.event_processing=!1,n.message=e.message}).error(function(e){n.event_processing=!1,n.message=e.message})}}]).controller("eventEditController",["$routeParams","Ticket",function(e,s){var t=this;t.eventData={},s.event.getOne(e.event_id).success(function(e){t.eventData=e.data}),t.saveEvent=function(){t.processing=!0,t.message="",s.event.update(t.eventData.id,t.eventData).success(function(e){t.processing=!1,t.message=e.message,$("html, body").animate({scrollTop:0},200)}).error(function(e){t.processing=!1,t.message=e.message})}}]).controller("feedbackController",["$scope","$location","Ticket",function(e,s,t){var c=this;c.comments={},c.processing=!0,c.getFeedback=function(){t.feedback.get().success(function(e){c.comments=e.data,c.processing=!1}).error(function(e){c.processing=!1,c.message=e})},c.getFeedback(),c.addComment=function(){c.processing=!0,c.message="",t.feedback.create(c.feedbackData).success(function(s){c.processing=!1,c.feedbackData={},e.commentform.$setPristine(),c.getFeedback(),c.message=s.message}).error(function(e){c.processing=!1,c.message=e.message})},c.deleteComment=function(e){c.processing=!0,t.feedback["delete"](e).success(function(e){e.success&&c.getFeedback(),c.processing=!1,c.message=e.message}).error(function(e){c.processing=!1,c.message=e.message})}}]).controller("feedbackEditController",["$routeParams","Ticket",function(e,s){var t=this;t.processing=!0,t.feedbackData={},s.feedback.getOne(e.fb_id).success(function(e){t.feedbackData=e.data,t.processing=!1}).error(function(e){t.processing=!1}),t.saveComment=function(){t.processing=!0,t.message="",s.feedback.update(t.feedbackData.id,t.feedbackData).success(function(e){t.processing=!1,t.message=e.message,$("html, body").animate({scrollTop:0},200)}).error(function(e){t.processing=!1,t.message=e.message})}}]);
angular.module("ticketService",[]).factory("Ticket",["$http",function(e){var t={};return t.get=function(t){return e.get("/api/tickets/"+t)},t.active=function(){return e.get("/api/tickets")},t.all=function(){return e.get("/api/tickets/all")},t.create=function(t){return e.post("/api/tickets/",t)},t.update=function(t,n){return e.put("/api/tickets/"+t,n)},t["delete"]=function(t){return e["delete"]("/api/tickets/"+t)},t.event={get:function(t){return e.get("/api/tickets/"+t+"/events")},getOne:function(t){return e.get("/api/events/"+t)},create:function(t,n){return e.post("/api/tickets/"+t+"/events",n)},update:function(t,n){return e.put("/api/events/"+t,n)},"delete":function(t){return e["delete"]("/api/events/"+t)}},t.feedback={get:function(){return e.get("/api/feedback/")},getOne:function(t){return e.get("/api/feedback/"+t)},create:function(t){return e.post("/api/feedback/",t)},update:function(t,n){return e.put("/api/feedback/"+t,n)},"delete":function(t){return e["delete"]("/api/feedback/"+t)}},t}]);
angular.module("userCtrl",["userService"]).controller("userController",["User",function(s){var e=this;e.processing=!0,s.all().success(function(s){0==s.success||null==s.data?e.users=null:e.users=s.data,e.processing=!1}).error(function(s){s&&(e.message=s),e.users=null,e.processing=!1}),e.deleteUser=function(r){e.processing=!0,e.users={},s["delete"](r).success(function(r){s.all().success(function(s){e.processing=!1,e.users=s.data,e.message="The user was successfully deleted!"})})}}]).controller("userCreateController",["$scope","User",function(s,e){var r=this;r.type="create",r.userData={},r.saveUser=function(){r.processing=!0,r.message="",e.create(r.userData).success(function(e){r.processing=!1,r.message=e.message,e.success&&(r.userData={},s.userform.$setPristine(),$("html, body").animate({scrollTop:0},200))})}}]).controller("userEditController",["$routeParams","User",function(s,e){var r=this;r.type="edit",e.get(s.user_id).success(function(s){r.userData=s.data}),r.saveUser=function(){r.processing=!0,r.message="",e.update(s.user_id,r.userData).success(function(s){r.processing=!1,r.message=s.message,$("html, body").animate({scrollTop:0},200)})}}]).controller("userProfileController",["$routeParams","User",function(s,e){var r=this;e.self().success(function(s){r.userData=s}),r.saveUser=function(){r.processing=!0,r.message="",e.update(r.userData.id,r.userData).success(function(s){r.processing=!1,r.message=s.message,$("html, body").animate({scrollTop:0},200)})}}]);
angular.module("userService",[]).factory("User",["$http",function(e){var t={};return t.get=function(t){return e.get("/api/users/"+t)},t.self=function(){return e.get("/api/me")},t.all=function(){return e.get("/api/users/")},t.create=function(t){return e.post("/api/users/",t)},t.update=function(t,r){return e.put("/api/users/"+t,r)},t["delete"]=function(t){return e["delete"]("/api/users/"+t)},t}]);
angular.module("comet",["app.routes","ngAnimate","authService","mainCtrl","userCtrl","userService","ticketCtrl","ticketService"]).config(["$httpProvider",function(e){e.interceptors.push("AuthInterceptor")}]);
angular.module("app.routes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"./views/pages/home.html"}).when("/signin",{templateUrl:"./views/pages/login.html",controller:"mainController",controllerAs:"login"}).when("/feedback",{templateUrl:"./views/pages/feedback/all.html",controller:"feedbackController",controllerAs:"feedback"}).when("/feedback/:fb_id/edit",{templateUrl:"./views/pages/feedback/edit.html",controller:"feedbackEditController",controllerAs:"feedback"}).when("/forbidden",{templateUrl:"./views/pages/403.html"}).when("/users",{templateUrl:"./views/pages/users/all.html",controller:"userController",controllerAs:"user"}).when("/users/create",{templateUrl:"./views/pages/users/create.html",controller:"userCreateController",controllerAs:"user"}).when("/users/:user_id",{templateUrl:"./views/pages/users/edit.html",controller:"userEditController",controllerAs:"user"}).when("/profile",{templateUrl:"./views/pages/profile.html",controller:"userProfileController",controllerAs:"user"}).when("/tickets",{templateUrl:"./views/pages/tickets/all.html",controller:"ticketController",controllerAs:"ticket"}).when("/tickets/all",{templateUrl:"./views/pages/tickets/all.html",controller:"ticketAllController",controllerAs:"ticket"}).when("/tickets/create",{templateUrl:"./views/pages/tickets/create.html",controller:"ticketCreateController",controllerAs:"ticket"}).when("/tickets/:ticket_id/edit",{templateUrl:"./views/pages/tickets/edit.html",controller:"ticketEditController",controllerAs:"ticket"}).when("/tickets/:ticket_id",{templateUrl:"./views/pages/tickets/single.html",controller:"ticketViewController",controllerAs:"ticket"}).when("/events/:event_id/edit",{templateUrl:"./views/pages/events/edit.html",controller:"eventEditController",controllerAs:"event"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}]);
//# sourceMappingURL=app.min.js.map
